from ga4gh_json_canonical.functions import dict_to_sorted_by_utf16_tuple, to_utf16_tuple
from ga4gh_json_canonical.util import JSON, preprocess_json_data


def test_to_utf16_tuple():
    assert to_utf16_tuple('â‚¬') == (8364,)
    assert to_utf16_tuple('1') == (49,)
    assert to_utf16_tuple('\r') == (13,)
    assert to_utf16_tuple('ï¬³') == (64307,)
    assert to_utf16_tuple('ðŸ˜€') == (55357, 56832)
    assert to_utf16_tuple('\x80') == (128,)
    assert to_utf16_tuple('Ã¶') == (246,)
    assert to_utf16_tuple('â‚¬1\rï¬³ðŸ˜€\x80Ã¶') == (8364, 49, 13, 64307, 55357, 56832, 128, 246)


def test_dict_to_sorted_by_utf16_tuple():
    assert dict_to_sorted_by_utf16_tuple({'b': 2, 'a': 1}) == {'a': 1, 'b': 2}
    assert dict_to_sorted_by_utf16_tuple({'ðŸ˜€ï¬³': 2, 'ï¬³ðŸ˜€': 1}) == {'ï¬³ðŸ˜€': 1, 'ðŸ˜€ï¬³': 2}


def test_dict_to_sorted_by_utf16_tuple_recursive():
    def dict_to_sorted_by_utf16_tuple_recursive(data: JSON):
        return preprocess_json_data(data, dict_func=dict_to_sorted_by_utf16_tuple)

    assert dict_to_sorted_by_utf16_tuple_recursive({
        'b': {
            'd': 3, 'c': 2
        }, 'a': 1
    }) == {
        'b': {
            'c': 2, 'd': 3
        }, 'a': 1
    }
    assert dict_to_sorted_by_utf16_tuple_recursive({
        'a': [{
            'ðŸ˜€ï¬³': 3, 'ï¬³ðŸ˜€': 2
        }, 4], 'b': 2
    }) == {
        'a': [{
            'ï¬³ðŸ˜€': 2, 'ðŸ˜€ï¬³': 3
        }, 4], 'b': 2
    }
